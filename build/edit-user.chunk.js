webpackJsonp([6],{14:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(4),n=l(s);t.default=n.default.createClass({displayName:"MessageBox",render:function(){return""===this.props.message?n.default.createElement("div",null):n.default.createElement("div",{className:"card red"},n.default.createElement("div",{className:"card-content white-text"},this.props.message))}})},399:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(4),n=l(s),o=a(39),i=a(24),r=l(i),u=a(14),d=l(u);t.default=n.default.createClass({displayName:"EditUserByAdmin",getInitialState:function(){return{hasLocal:!1,hasFacebook:!1,hasGoogle:!1,id:"",expectedKcal:"",role:"",loginFailCount:0,profileUrl:"",localFile:"",imagePreviewUrl:"",name:"",email:"",password:"",facebook:"",google:"",status:"EDITING",userCopy:"",message:""}},componentDidMount:function(){var e=this,t="/api/users?userId="+this.props.params.id;r.default.get(t,{headers:{token:localStorage.getItem("MealAppToken")}}).then(function(t){var a=t.data.user;e.setState({userCopy:a}),e.updateUserState(a)}).catch(function(t){return e.setState({message:t.response.status+": "+t.response.data.message})})},updateUserState:function(e){void 0!=e.local.email&&this.setState({hasLocal:!0}),void 0!=e.facebook&&this.setState({hasFacebook:!0}),void 0!=e.google&&this.setState({hasGoogle:!0}),this.setState({id:e._id,expectedKcal:e.expectedKcal,role:e.role,loginFailCount:e.local.loginFailCount}),this.state.hasLocal&&this.setState({name:e.local.name,email:e.local.email}),this.state.hasFacebook&&this.setState({facebook:e.facebook}),this.state.hasGoogle&&this.setState({google:e.google}),null!=e.profilePic&&void 0!=e.profilePic?this.setState({profileUrl:"/api/images?imageId="+e.profilePic}):this.state.hasFacebook?this.setState({profileUrl:e.facebook.profilePicUrl}):this.state.hasGoogle&&this.setState({profileUrl:e.google.profilePicUrl}),console.log(this.state.profileUrl)},handleUserInfoUpdate:function(){var e=this;if(this.state.hasLocal&&""==this.state.name)return void this.setState({message:"Please enter a valid name"});this.setState({status:"LOADING",message:"Saving profile..."});var t="/api/users?userId="+this.state.id,a={name:this.state.name,expectedKcal:this.state.expectedKcal};""!=this.state.password&&(a.password=this.state.password),0==this.state.loginFailCount&&(a.loginFailCount=0),console.log(a),r.default.put(t,a,{headers:{token:localStorage.getItem("MealAppToken")}}).then(function(t){e.setState({message:t.data.message,password:""}),localStorage.setItem("MealAppExpectedKcal",e.state.expectedKcal),e.setState({status:"EDITING",message:"Record updated"})}).catch(function(t){e.setState({message:t.response.status+": "+t.response.data.message}),e.setState({status:"EDITING",message:""})})},handleReset:function(){this.updateUserState(this.state.userCopy)},handleFileSelect:function(e){e.preventDefault(),this.setState({localFile:e.target.files[0]});var t=new FileReader,a=e.target.files[0];t.addEventListener("load",function(){document.getElementById("profileImg").src=t.result},!1),t.readAsDataURL(a)},handleSubmit:function(e){var t=this;e.preventDefault();var a="/api/images?userId="+this.props.params.id,l=new FormData;l.append("file",this.state.localFile);var s={headers:{"content-type":"multipart/form-data",token:localStorage.getItem("MealAppToken")}};r.default.post(a,l,s).then(function(e){t.setState({message:e.data.message}),document.getElementById("file").value=""}).catch(function(e){return t.setState({message:e.response.status+": "+e.response.data.message})})},handleDelete:function(){var e=this,t="/api/users?userId="+this.props.params.id;r.default.delete(t,{headers:{token:localStorage.getItem("MealAppToken")}}).then(function(e){o.browserHistory.push("/users")}).catch(function(t){return e.setState({message:t.response.status+": "+t.response.data.message})})},render:function(){var e=this;return n.default.createElement("div",null,n.default.createElement("h3",null,"Edit/Delete user as admin"),n.default.createElement(d.default,{message:this.state.message}),n.default.createElement("div",null,n.default.createElement("p",null,"User ID: ",this.props.params.id),n.default.createElement("p",null,"Local email: ",this.state.email),n.default.createElement("label",null,"User role: "),n.default.createElement("input",{className:"localField",type:"text",value:this.state.role,disabled:"EDITING"!=this.state.status,onChange:function(t){return e.setState({role:t.target.value})}}),n.default.createElement("br",null),n.default.createElement("label",null,"Local name: "),n.default.createElement("input",{className:"localField",type:"text",value:this.state.name,disabled:"EDITING"!=this.state.status||!this.state.hasLocal,onChange:function(t){return e.setState({name:t.target.value})}}),n.default.createElement("br",null),n.default.createElement("label",null,"New password: "),n.default.createElement("input",{className:"localField",type:"password",value:this.state.password,disabled:"EDITING"!=this.state.status||!this.state.hasLocal,onChange:function(t){return e.setState({password:t.target.value})}}),n.default.createElement("br",null),n.default.createElement("label",null,"Planned daily energy intake: "),n.default.createElement("input",{className:"localField",type:"number",value:this.state.expectedKcal,disabled:"EDITING"!=this.state.status,onChange:function(t){return e.setState({expectedKcal:t.target.value})}}),n.default.createElement("br",null),n.default.createElement("label",null,"Login failure count: "),n.default.createElement("input",{className:"localField",type:"text",value:this.state.loginFailCount,disabled:"EDITING"!=this.state.status,onChange:function(t){return e.setState({loginFailCount:t.target.value})}}),n.default.createElement("br",null)),n.default.createElement("div",{className:"card-green"},n.default.createElement("div",{className:"card-content white-text"},n.default.createElement("p",null,"Facebook ID: ",void 0==this.state.facebook?"N/A":this.state.facebook.id),n.default.createElement("p",null,"Facebook name: ",void 0==this.state.facebook?"N/A":this.state.facebook.name),n.default.createElement("p",null,"Facebook email: ",void 0==this.state.facebook?"N/A":this.state.facebook.email),n.default.createElement("br",null),n.default.createElement("p",null,"Google ID: ",void 0==this.state.google?"N/A":this.state.google.id),n.default.createElement("p",null,"Google name: ",void 0==this.state.google?"N/A":this.state.google.name),n.default.createElement("p",null,"Google email: ",void 0==this.state.google?"N/A":this.state.google.email))),n.default.createElement("input",{type:"button",value:"Save",onClick:this.handleUserInfoUpdate}),n.default.createElement("input",{type:"button",value:"Reset",onClick:this.handleReset}),n.default.createElement("input",{type:"button",value:"Delete user",onClick:this.handleDelete}),n.default.createElement("br",null),n.default.createElement("div",null,n.default.createElement("img",{id:"profileImg",src:this.state.profileUrl}),n.default.createElement("form",{onSubmit:this.handleSubmit},n.default.createElement("input",{type:"file",id:"file",accept:"image/jpg",onChange:this.handleFileSelect}),n.default.createElement("input",{type:"submit",value:"Upload profile picture"}))))}})}});